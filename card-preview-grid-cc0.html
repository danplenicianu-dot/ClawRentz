<!doctype html>
<html lang="ro">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Preview grid (CC0)</title>
  <style>
    :root{--bg:#f2f2f7;--card:#fff;--ink:#111114;--line:rgba(0,0,0,.10)}
    *{box-sizing:border-box}
    body{margin:0;background:var(--bg);font-family:-apple-system,BlinkMacSystemFont,system-ui,Segoe UI,Roboto,Arial;color:var(--ink)}
    header{position:sticky;top:0;z-index:2;background:rgba(242,242,247,.88);backdrop-filter:blur(12px);-webkit-backdrop-filter:blur(12px);border-bottom:1px solid rgba(0,0,0,.06);padding:12px 16px}
    .title{font-size:15px;font-weight:950;letter-spacing:-.02em}
    .sub{margin-top:6px;font-size:12px;opacity:.7;line-height:1.35}
    main{padding:14px 16px 34px;max-width:1180px;margin:0 auto}

    .panel{background:var(--card);border:1px solid var(--line);border-radius:16px;padding:12px;}
    .row{display:flex;align-items:center;justify-content:space-between;gap:12px;flex-wrap:wrap}
    .controls{display:flex;gap:8px;flex-wrap:wrap}
    button{border:1px solid rgba(0,0,0,.10);background:#fff;border-radius:12px;padding:8px 10px;font-weight:900;cursor:pointer;font-size:12px}
    .hint{font-size:12px;opacity:.7}

    .grid{margin-top:12px;display:grid;grid-template-columns: 54px repeat(8, 1fr);gap:10px;align-items:center}
    .suitLabel{font-weight:950;font-size:18px;opacity:.9;text-align:center}
    .rankLabel{font-weight:950;font-size:12px;opacity:.65;text-align:center}

    .cardBox{display:flex;flex-direction:column;gap:6px;align-items:center}
    .cardSvg{width:120px;max-width:100%;aspect-ratio: 2/3;border-radius:14px;overflow:hidden;border:1px solid rgba(0,0,0,.10);background:#fff;box-shadow:0 18px 40px rgba(0,0,0,.10)}

    @media (max-width: 980px){
      .grid{grid-template-columns: 42px repeat(4, 1fr)}
      .rankHeader{display:none}
    }
  </style>
</head>
<body>
<header>
  <div class="title">Preview grid — CC0 (32 cărți: A,K,Q,J,10,9,8,7 × 4)</div>
  <div class="sub">Crop automat din sheet-ul CC0. Dacă un crop e deplasat, ajustez formula înainte să ating jocul.</div>
</header>

<main>
  <div class="panel">
    <div class="row">
      <div class="controls">
        <button id="btnSpadesFirst">Ordine: ♠ ♣ ♥ ♦</button>
        <button id="btnHeartsFirst">Ordine: ♥ ♦ ♣ ♠</button>
      </div>
      <div class="hint">Sursă: <code>assets/cards/english-pattern-cc0.svg</code></div>
    </div>

    <div class="grid" id="grid"></div>
  </div>
</main>

<script>
  const SHEET = './assets/cards/english-pattern-cc0.svg';

  // Layout constants (derived from CC0 sheet geometry)
  // Assumption: 13 columns (A..K), 4 rows (♠ ♥ ♦ ♣ or similar) with a 30px margin and 390×570 cell.
  const MARGIN_X = 30;
  const MARGIN_Y = 30;
  const CELL_W = 390;
  const CELL_H = 570;
  const CARD_W = 360;
  const CARD_H = 540;

  // Column indices in the CC0 sheet: Ace on the left ... King on the right
  const COL = { A:0, '2':1, '3':2, '4':3, '5':4, '6':5, '7':6, '8':7, '9':8, '10':9, J:10, Q:11, K:12 };
  const RANKS = ['A','K','Q','J','10','9','8','7'];

  // Row indices (we will provide two common suit orders; if needed, we can swap rows)
  // We'll start with an educated guess: row0 ♠, row1 ♥, row2 ♦, row3 ♣ (English pattern is commonly ordered that way).
  const ROW_DEFAULT = { '♠':0, '♥':1, '♦':2, '♣':3 };

  function cropViewBox(rank, suit, rowMap){
    const col = COL[rank];
    const row = rowMap[suit];
    const x = MARGIN_X + CELL_W * col;
    const y = MARGIN_Y + CELL_H * row;
    return `${x} ${y} ${CARD_W} ${CARD_H}`;
  }

  function cardCropSvg(rank, suit, rowMap){
    const vb = cropViewBox(rank, suit, rowMap);
    // Use <image> to reference the big SVG (same-origin). This works well in modern browsers.
    return `
      <svg viewBox="${vb}" width="100%" height="100%" xmlns="http://www.w3.org/2000/svg">
        <image href="${SHEET}" x="0" y="0" width="5109.1855" height="2882.8103" />
      </svg>
    `;
  }

  function render(order){
    const grid = document.getElementById('grid');
    grid.innerHTML='';

    // rank header row
    grid.appendChild(document.createElement('div'));
    for(const r of RANKS){
      const d = document.createElement('div');
      d.className='rankLabel rankHeader';
      d.textContent = r;
      grid.appendChild(d);
    }

    const rowMap = ROW_DEFAULT; // If CC0 turns out different, we tweak here.
    for(const suit of order){
      const lbl = document.createElement('div');
      lbl.className='suitLabel';
      lbl.textContent = suit;
      grid.appendChild(lbl);

      for(const r of RANKS){
        const wrap = document.createElement('div');
        wrap.className='cardBox';
        const box = document.createElement('div');
        box.className='cardSvg';
        box.innerHTML = cardCropSvg(r, suit, rowMap);
        wrap.appendChild(box);
        grid.appendChild(wrap);
      }
    }
  }

  document.getElementById('btnSpadesFirst').onclick = ()=>render(['♠','♣','♥','♦']);
  document.getElementById('btnHeartsFirst').onclick = ()=>render(['♥','♦','♣','♠']);

  render(['♠','♣','♥','♦']);
</script>
</body>
</html>
